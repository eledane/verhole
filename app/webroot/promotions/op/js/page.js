$(function() {
    function runFQGAnimation() {
        var index = 0;
        var $prods = $(".section-fqg2 .prod");

        function fqgLoop() {
            var oldIndex = index;
            var oldPos, newPos;

            index++;
            if (index == 6) index = 1;

            $prods.each(function(i) {
                oldPos = oldIndex + i;
                if (oldPos > 5) oldPos -= 5;
                newPos = index + i;
                if (newPos > 5) newPos -= 5;
                $(this).removeClass("pos-" + oldPos).addClass("pos-" + newPos);
            });
            setTimeout(fqgLoop, 3e3);
        }

        fqgLoop();
    }

    function runProcessAnimation() {
        var index = 0;
        var $files = $(".section-process2 .options .file");

        function fqgLoop() {
            var oldIndex = index;
            var oldPos, newPos;

            index++;
            if (index == 7) index = 1;

            $files.each(function(i) {
                oldPos = oldIndex + i;
                if (oldPos > 6) oldPos -= 6;
                newPos = index + i;
                if (newPos > 6) newPos -= 6;
                $(this).removeClass("pos-" + oldPos).addClass("pos-" + newPos);
            });
            setTimeout(fqgLoop, 3e3);
        }

        fqgLoop();
    }

    if ($(window).width() <= 640) {
        runFQGAnimation();
        runProcessAnimation();
    }

    var instalMap = {1006:"166.67",1007:"153.97",1008:"136.11",1009:"122.22",1010:"111.11",1011:"102.02",1012:"94.44",1013:"88.03",1014:"82.54",1015:"77.78",1016:"73.61",1017:"69.93",1018:"66.67",1019:"63.74",1020:"61.11",1021:"58.73",1022:"56.57",1023:"54.59",1024:"52.78",1506:"250",1507:"230.95",1508:"204.17",1509:"183.33",1510:"166.67",1511:"153.03",1512:"141.67",1513:"132.05",1514:"123.81",1515:"116.67",1516:"110.42",1517:"104.9",1518:"100",1519:"95.61",1520:"91.67",1521:"88.1",1522:"84.85",1523:"81.88",1524:"79.17",2006:"355.56",2007:"307.94",2008:"272.22",2009:"244.44",2010:"222.22",2011:"204.04",2012:"188.89",2013:"176.07",2014:"165.08",2015:"155.56",2016:"147.22",2017:"139.87",2018:"133.33",2019:"127.49",2020:"122.22",2021:"117.46",2022:"113.13",2023:"109.18",2024:"105.56",2506:"444.44",2507:"384.92",2508:"340.28",2509:"305.56",2510:"277.78",2511:"255.05",2512:"236.11",2513:"220.09",2514:"206.35",2515:"194.44",2516:"184.03",2517:"174.84",2518:"166.67",2519:"159.36",2520:"152.78",2521:"146.83",2522:"141.41",2523:"136.47",2524:"131.94",3006:"533.33",3007:"461.9",3008:"408.33",3009:"366.67",3010:"333.33",3011:"306.06",3012:"283.33",3013:"264.1",3014:"247.62",3015:"233.33",3016:"220.83",3017:"209.8",3018:"200",3019:"191.23",3020:"183.33",3021:"176.19",3022:"169.7",3023:"163.77",3024:"158.33",3508:"481.25",3509:"432.64",3510:"393.75",3511:"361.93",3512:"335.42",3513:"312.98",3514:"293.75",3515:"277.08",3516:"262.5",3517:"249.63",3518:"238.19",3519:"227.96",3520:"218.75",3521:"210.42",3522:"202.84",3523:"195.92",3524:"189.58",4008:"550",4009:"494.44",4010:"450",4011:"413.64",4012:"383.33",4013:"357.69",4014:"335.71",4015:"316.67",4016:"300",4017:"285.29",4018:"272.22",4019:"260.53",4020:"250",4021:"240.48",4022:"231.82",4023:"223.91",4024:"216.67",4508:"618.75",4509:"556.25",4510:"506.25",4511:"465.34",4512:"431.25",4513:"402.4",4514:"377.68",4515:"356.25",4516:"337.5",4517:"320.96",4518:"306.25",4519:"293.09",4520:"281.25",4521:"270.54",4522:"260.8",4523:"251.9",4524:"243.75",5008:"687.5",5009:"618.06",5010:"562.5",5011:"517.05",5012:"479.17",5013:"447.12",5014:"419.64",5015:"395.83",5016:"375",5017:"356.62",5018:"340.28",5019:"325.66",5020:"312.5",5021:"300.6",5022:"289.77",5023:"279.89",5024:"270.83",5508:"756.25",5509:"679.86",5510:"618.75",5511:"568.75",5512:"527.08",5513:"491.83",5514:"461.61",5515:"435.42",5516:"412.5",5517:"392.28",5518:"374.31",5519:"358.22",5520:"343.75",5521:"330.65",5522:"318.75",5523:"307.88",5524:"297.92",6008:"825",6009:"741.67",6010:"675",6011:"620.45",6012:"575",6013:"536.54",6014:"503.57",6015:"475",6016:"450",6017:"427.94",6018:"408.33",6019:"390.79",6020:"375",6021:"360.71",6022:"347.73",6023:"335.87",6024:"325",6520:"417.86",6521:"402.38",6522:"388.31",6523:"375.47",6524:"363.69",7020:"450",7021:"433.33",7022:"418.18",7023:"404.35",7024:"391.67",7520:"482.14",7521:"464.29",7522:"448.05",7523:"433.23",7524:"419.64",8020:"514.29",8021:"495.24",8022:"477.92",8023:"462.11",8024:"447.62",8520:"546.43",8521:"526.19",8522:"507.79",8523:"490.99",8524:"475.6",9020:"578.57",9021:"557.14",9022:"537.66",9023:"519.88",9024:"503.57",9520:"610.71",9521:"588.1",9522:"567.53",9523:"548.76",9524:"531.55",10020:"642.86",10021:"619.05",10022:"597.4",10023:"577.64",10024:"559.52"};

    var termList = [6, 7, 8, 9, 10,11,12,13,14,15,16,17,18,19,20,21,22,23,24];

    var laMap = {
        6: 3000,
        7: 3000,
        8: 6000,
        9: 6000,
        10: 6000,
        11: 6000,
        12: 6000,
        13: 6000,
        14: 6000,
        15: 6000,
        16: 6000,
        17: 6000,
        18: 6000,
        19: 6000,
        20: 10000,
        21: 10000,
        22: 10000,
        23: 10000,
        24: 10000,
        25: 10000
    };

    var $slideAmount = $("#slider-amount");
    var $slideMonths = $("#slider-months");
    var $calcResult = $("#calc-result");

    var $slideAmountValue = $("<span class='value' />");
    var $slideMonthsValue = $("<span class='value' />");

    $slideAmount.slider({
        min: 1000,
        max: 10000,
        step: 500,
        value: 5000,
        range: "min",
        create: function() {
            $slideAmount.find(".ui-slider-handle").append($slideAmountValue.text(5000));
            $slideAmount.after("<span class='min'>1000</span>").after("<span class='max'>10000</span>");
        },
        slide: function(event, ui) {
            var amount = ui.value;
            $slideAmountValue.text(amount);

            var months = termList[$slideMonths.slider("value")];

            $calcResult.text(instalMap[amount + months]);
        }
    });

    $slideMonths.slider({
        min: 0,
        max: 18,
        value: 9,
        range: "min",
        create: function() {
            $slideMonths.find(".ui-slider-handle").append($slideMonthsValue.text(termList[9]));
            $slideMonths.after("<span class='min'>" + termList[0] + "</span>").after("<span class='max'>" + termList[18] + "</span>");
        },
        slide: function(event, ui) {
            var months = termList[ui.value];
            // $slideAmountValue.text(amount);
            $slideMonthsValue.text(months);

            var amoutMax = laMap[months];
            $slideAmount.slider("option", "max", amoutMax);
            $slideAmount.siblings(".max").text(amoutMax);

            var amount = $slideAmount.slider("value");

            $slideAmountValue.text(amount);
            $calcResult.text(instalMap[amount + months]);
        }
    });

    $calcResult.text(instalMap[5000 + termList[9]]);
});
